<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>General information on creating a forecast object — as_forecast • scoringutils</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="General information on creating a forecast object — as_forecast"><meta name="description" content="There are several “as_forecast_()functions to process and validate a data.frame (or similar) or similar with forecasts and observations. If the input passes all input checks, those functions will be converted to aforecast` object. A forecast object is a `data.table` with a
class `forecast` and an additional class that depends on the forecast type.
Every forecast type has its own `as_forecast_()` function.
See the details section below for more information
on the expected input formats.
The as_forecast_&amp;lt;type&amp;gt;() functions give users some control over how their
data is parsed.
Using the arguments observed, predicted, model, etc. users can rename
existing columns of their input data to match the required columns for a
forecast object. Using the argument forecast_unit, users can specify the
the columns that uniquely identify a single forecast (and remove the others,
see set_forecast_unit() for details).
The following functions are available:
as_forecast_point()
as_forecast_binary()
as_forecast_sample()
as_forecast_quantile()

"><meta property="og:description" content="There are several “as_forecast_()functions to process and validate a data.frame (or similar) or similar with forecasts and observations. If the input passes all input checks, those functions will be converted to aforecast` object. A forecast object is a `data.table` with a
class `forecast` and an additional class that depends on the forecast type.
Every forecast type has its own `as_forecast_()` function.
See the details section below for more information
on the expected input formats.
The as_forecast_&amp;lt;type&amp;gt;() functions give users some control over how their
data is parsed.
Using the arguments observed, predicted, model, etc. users can rename
existing columns of their input data to match the required columns for a
forecast object. Using the argument forecast_unit, users can specify the
the columns that uniquely identify a single forecast (and remove the others,
see set_forecast_unit() for details).
The following functions are available:
as_forecast_point()
as_forecast_binary()
as_forecast_sample()
as_forecast_quantile()

"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">scoringutils</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.2.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://raw.githubusercontent.com/epiforecasts/scoringutils/main/inst/manuscript/manuscript.pdf">scoringutils paper</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Deprecated-functions.html">Deprecated functions</a></li>
    <li><a class="dropdown-item" href="../articles/Deprecated-visualisations.html">Deprecated Visualisations</a></li>
    <li><a class="dropdown-item" href="../articles/scoring-rules.html">Scoring rules in `scoringutils`</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiforecasts/scoringutils/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>General information on creating a <code>forecast</code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/epiforecasts/scoringutils/blob/main/R/forecast.R" class="external-link"><code>R/forecast.R</code></a></small>
      <div class="d-none name"><code>as_forecast.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>There are several “as_forecast_<type>()<code>functions to process and validate a data.frame (or similar) or similar with forecasts and observations. If the input passes all input checks, those functions will be converted to a</code>forecast` object. A forecast object is a `data.table` with a
class `forecast` and an additional class that depends on the forecast type.
Every forecast type has its own `as_forecast_<type>()` function.
See the details section below for more information
on the expected input formats.</type></type></p>
<p>The <code>as_forecast_&lt;type&gt;()</code> functions give users some control over how their
data is parsed.
Using the arguments <code>observed</code>, <code>predicted</code>, <code>model</code>, etc. users can rename
existing columns of their input data to match the required columns for a
forecast object. Using the argument <code>forecast_unit</code>, users can specify the
the columns that uniquely identify a single forecast (and remove the others,
see <code><a href="set_forecast_unit.html">set_forecast_unit()</a></code> for details).</p>
<p>The following functions are available:</p><ul><li><p><code><a href="as_forecast_point.html">as_forecast_point()</a></code></p></li>
<li><p><code><a href="as_forecast_binary.html">as_forecast_binary()</a></code></p></li>
<li><p><code><a href="as_forecast_sample.html">as_forecast_sample()</a></code></p></li>
<li><p><code><a href="as_forecast_quantile.html">as_forecast_quantile()</a></code></p></li>
</ul></div>


    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame (or similar) with predicted and observed values.
See the details section of <code>as_forecast()</code> for additional information
on required input formats.</p></dd>


<dt id="arg-forecast-unit">forecast_unit<a class="anchor" aria-label="anchor" href="#arg-forecast-unit"></a></dt>
<dd><p>(optional) Name of the columns in <code>data</code> (after
any renaming of columns) that denote the unit of a
single forecast. See <code><a href="get_forecast_unit.html">get_forecast_unit()</a></code> for details.
If <code>NULL</code> (the default), all columns that are not required columns are
assumed to form the unit of a single forecast. If specified, all columns
that are not part of the forecast unit (or required columns) will be removed.</p></dd>


<dt id="arg-observed">observed<a class="anchor" aria-label="anchor" href="#arg-observed"></a></dt>
<dd><p>(optional) Name of the column in <code>data</code> that contains the
observed values. This column will be renamed to "observed".</p></dd>


<dt id="arg-predicted">predicted<a class="anchor" aria-label="anchor" href="#arg-predicted"></a></dt>
<dd><p>(optional) Name of the column in <code>data</code> that contains the
predicted values. This column will be renamed to "predicted".</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>(optional) Name of the column in <code>data</code> that contains the names
of the models/forecasters that generated the predicted values.
This column will be renamed to "model".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Depending on the forecast type, an object of the following class will be
returned:</p><ul><li><p><code>forecast_binary</code> for binary forecasts</p></li>
<li><p><code>forecast_point</code> for point forecasts</p></li>
<li><p><code>forecast_sample</code> for sample-based forecasts</p></li>
<li><p><code>forecast_quantile</code> for quantile-based forecasts</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="forecast-types-and-input-formats">Forecast types and input formats<a class="anchor" aria-label="anchor" href="#forecast-types-and-input-formats"></a></h2>
    <p>Various different forecast types / forecast formats are supported. At the
moment, those are:</p><ul><li><p>point forecasts</p></li>
<li><p>binary forecasts ("soft binary classification")</p></li>
<li><p>Probabilistic forecasts in a quantile-based format (a forecast is
represented as a set of predictive quantiles)</p></li>
<li><p>Probabilistic forecasts in a sample-based format (a forecast is represented
as a set of predictive samples)</p></li>
</ul><p>Forecast types are determined based on the columns present in the input data.
Here is an overview of the required format for each forecast type:

  </p><div style="text-align: left">
  <img src="figures/required-inputs.png" style="width:750px;max-width:100%;"></div>
<p><em>All forecast types</em> require a data.frame or similar with columns <code>observed</code>
<code>predicted</code>, and <code>model</code>.</p>
<p><em>Point forecasts</em> require a column <code>observed</code> of type numeric and a column
<code>predicted</code> of type numeric.</p>
<p><em>Binary forecasts</em> require a column <code>observed</code> of type factor with exactly
two levels and a column <code>predicted</code> of type numeric with probabilities,
corresponding to the probability that <code>observed</code> is equal to the second
factor level. See details <a href="scoring-functions-binary.html">here</a> for more information.</p>
<p><em>Quantile-based forecasts</em> require a column <code>observed</code> of type numeric,
a column <code>predicted</code> of type numeric, and a column <code>quantile_level</code> of type
numeric with quantile-levels (between 0 and 1).</p>
<p><em>Sample-based forecasts</em> require a column <code>observed</code> of type numeric,
a column <code>predicted</code> of type numeric, and a column <code>sample_id</code> of type
numeric with sample indices.</p>
<p>For more information see the vignettes and the example data
(<a href="example_quantile.html">example_quantile</a>, <a href="example_sample_continuous.html">example_sample_continuous</a>, <a href="example_sample_discrete.html">example_sample_discrete</a>,
<code><a href="example_point.html">example_point()</a></code>, and <a href="example_binary.html">example_binary</a>).</p>
    </div>
    <div class="section level2">
    <h2 id="forecast-unit">Forecast unit<a class="anchor" aria-label="anchor" href="#forecast-unit"></a></h2>
    <p>In order to score forecasts, <code>scoringutils</code> needs to know which of the rows
of the data belong together and jointly form a single forecasts. This is
easy e.g. for point forecast, where there is one row per forecast. For
quantile or sample-based forecasts, however, there are multiple rows that
belong to a single forecast.</p>
<p>The <em>forecast unit</em> or <em>unit of a single forecast</em> is then described by the
combination of columns that uniquely identify a single forecast.
For example, we could have forecasts made by different models in various
locations at different time points, each for several weeks into the future.
The forecast unit could then be described as
<code>forecast_unit = c("model", "location", "forecast_date", "forecast_horizon")</code>.
<code>scoringutils</code> automatically tries to determine the unit of a single
forecast. It uses all existing columns for this, which means that no columns
must be present that are unrelated to the forecast unit. As a very simplistic
example, if you had an additional row, "even", that is one if the row number
is even and zero otherwise, then this would mess up scoring as <code>scoringutils</code>
then thinks that this column was relevant in defining the forecast unit.</p>
<p>In order to avoid issues, we recommend setting the forecast unit explicitly,
usually through the <code>forecast_unit</code> argument in the <code>as_forecast()</code>
functions. This will drop unneeded columns, while making sure that all
necessary, 'protected columns' like "predicted" or "observed" are retained.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other functions to create forecast objects:
<code><a href="as_forecast_binary.html">as_forecast_binary</a>()</code>,
<code><a href="as_forecast_point.html">as_forecast_point</a>()</code>,
<code><a href="as_forecast_quantile.html">as_forecast_quantile</a>()</code>,
<code><a href="as_forecast_sample.html">as_forecast_sample</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="as_forecast_binary.html">as_forecast_binary</a></span><span class="op">(</span><span class="va">example_binary</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Some rows containing NA values may be removed. This is fine if not</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   unexpected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Forecast type: </span>binary</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Forecast unit:</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> location, location_name, target_end_date, target_type, forecast_date, model,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> and horizon</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       location location_name target_end_date target_type forecast_date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;char&gt;        &lt;char&gt;          &lt;Date&gt;      &lt;char&gt;        &lt;Date&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:       DE       Germany      2021-01-02       Cases          &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:       DE       Germany      2021-01-02      Deaths          &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:       DE       Germany      2021-01-09       Cases          &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:       DE       Germany      2021-01-09      Deaths          &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:       DE       Germany      2021-01-16       Cases          &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1027:       IT         Italy      2021-07-24      Deaths    2021-07-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1028:       IT         Italy      2021-07-24      Deaths    2021-07-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1029:       IT         Italy      2021-07-24      Deaths    2021-07-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1030:       IT         Italy      2021-07-24      Deaths    2021-07-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1031:       IT         Italy      2021-07-24      Deaths    2021-07-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       model horizon predicted observed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;char&gt;   &lt;num&gt;     &lt;num&gt;   &lt;fctr&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    1:                  &lt;NA&gt;      NA        NA     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    2:                  &lt;NA&gt;      NA        NA     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3:                  &lt;NA&gt;      NA        NA     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    4:                  &lt;NA&gt;      NA        NA     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    5:                  &lt;NA&gt;      NA        NA     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ---                                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1027: EuroCOVIDhub-baseline       2     0.250        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1028:       UMass-MechBayes       3     0.475        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1029:       UMass-MechBayes       2     0.450        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1030:  epiforecasts-EpiNow2       3     0.375        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1031:  epiforecasts-EpiNow2       2     0.300        0</span>
<span class="r-in"><span><span class="fu"><a href="as_forecast_quantile.html">as_forecast_quantile</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">example_quantile</span>,</span></span>
<span class="r-in"><span>  forecast_unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"model"</span>, <span class="st">"target_type"</span>, <span class="st">"target_end_date"</span>,</span></span>
<span class="r-in"><span>                    <span class="st">"horizon"</span>, <span class="st">"location"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Some rows containing NA values may be removed. This is fine if not</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   unexpected.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Forecast type: </span>quantile</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #0000BB;">Forecast unit:</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> model, target_type, target_end_date, horizon, and location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key: &lt;location, target_end_date, target_type&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        observed quantile_level predicted                model target_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           &lt;num&gt;          &lt;num&gt;     &lt;int&gt;               &lt;char&gt;      &lt;char&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1:   127300             NA        NA                 &lt;NA&gt;       Cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2:     4534             NA        NA                 &lt;NA&gt;      Deaths</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3:   154922             NA        NA                 &lt;NA&gt;       Cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4:     6117             NA        NA                 &lt;NA&gt;      Deaths</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5:   110183             NA        NA                 &lt;NA&gt;       Cases</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ---                                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20541:       78          0.850       352 epiforecasts-EpiNow2      Deaths</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20542:       78          0.900       397 epiforecasts-EpiNow2      Deaths</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20543:       78          0.950       499 epiforecasts-EpiNow2      Deaths</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20544:       78          0.975       611 epiforecasts-EpiNow2      Deaths</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20545:       78          0.990       719 epiforecasts-EpiNow2      Deaths</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        target_end_date horizon location</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 &lt;Date&gt;   &lt;num&gt;   &lt;char&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1:      2021-01-02      NA       DE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2:      2021-01-02      NA       DE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3:      2021-01-09      NA       DE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4:      2021-01-09      NA       DE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5:      2021-01-16      NA       DE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ---                                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20541:      2021-07-24       2       IT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20542:      2021-07-24       2       IT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20543:      2021-07-24       2       IT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20544:      2021-07-24       2       IT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20545:      2021-07-24       2       IT</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://followtheargument.org/" class="external-link">Nikos Bosse</a>, <a href="https://www.samabbott.co.uk/" class="external-link">Sam Abbott</a>, Hugo Gruson, Sebastian Funk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

    </footer></div>





  </body></html>

